' Gambas class file

Static Public hPic As Picture

Static Public Sub LoadIMages(Picture As Picture, x As Float, y As Float)
  
  Paint.Begin(hPic)
  Paint.DrawPicture(Picture, x, y)
  Paint.End
  
End

Public Sub loadModule(PathToModule As String)
  
  Dim s As XmlElement
  
  Dim doc As New XmlDocument(pathtoModule & "/ModuleCall.xml")
  
  hPic = New Picture(3840, 2160, True)
  Paint.Begin(hPic)
  For Each s In doc.GetElementsByTagName("Images")
    
    Paint.DrawPicture(Picture.Load(pathtoModule & "/" & s.GetAttribute("IMGPath")), CFloat(s.GetAttribute("X")), CFloat(s.GetAttribute("Y")))
    
  Next
  
  For Each s In doc.GetElementsByTagName("Text")
    
    Paint.Font = Font[s.GetAttribute("Font")]
    Paint.Text(s.GetAttribute("Description"), CFloat(s.GetAttribute("X")), CFloat(s.GetAttribute("Y")), 1000, 100)
    Paint.Stroke()
  Next
  Paint.End()
  
End

Public Sub Form_Open()
  
  hPic = New Picture(3840, 2160, True)
  
  ScrollArea1.ResizeContents(hPic.w, hPic.h)
  
  ' Paint.Begin(hPic)
  ' 
  ' Paint.Brush = Paint.Color(Color.Cyan)
  ' Paint.LineWidth = 4
  ' Paint.DrawPicture(Picture.Load("Blue.png"), 55, 1715)
  ' Paint.DrawPicture(Picture.Load("red.png"), 2257, 60)
  ' 
  ' 
  ' ' Paint.Rectangle(58, 1718, 360, 320)
  ' ' Paint.Stroke()
  ' ' 
  ' ' Paint.Brush = Paint.Color(Color.black)
  ' ' Paint.LineWidth = 10
  ' ' Paint.LineCap = Paint.LineCapRound
  ' ' Paint.MoveTo(0, 0)
  ' ' Paint.MoveTo(419, 1955)
  ' ' Paint.RelLineTo(-54, 84)
  ' ' Paint.RelLineTo(20, 0)
  ' ' Paint.RelLineTo(34, -64)
  ' ' Paint.RelLineTo(0, -20)
  ' ' Paint.Fill()
  ' ' 
  ' ' Paint.Brush = Paint.Color(Color.Cyan)
  ' ' Paint.Rectangle(419, 1955, 1200, 85)
  ' ' Paint.Fill()
  ' ' Paint.Brush = Paint.Color(Color.Black)
  ' ' Paint.LineWidth = 5
  ' ' Paint.Rectangle(424, 1958, 1198, 80)
  ' ' Paint.Stroke()
  ' 
  ' Paint.Brush = Paint.Color(0)
  ' Paint.Font = Font["Tarrget 3D Italic,60"] ' 3D Italic
  ' Paint.Text("Bisam97", 595, 1955, 30, 30)
  ' 
  ' Paint.Stroke()
  ' 
  ' Paint.MoveTo(1500, 2000)
  ' Paint.Background = Color.Transparent
  ' 
  ' 
  ' Paint.Arc(1500, 2000, 32)
  ' Paint.Fill()
  ' 
  ' Paint.Stroke()
  ' Paint.End
  ' ScrollArea1.Refresh()
  ' Message.Info("Fertig")
  
End

Public Sub Button1_Click()
  
  Dialog.Title = "Speichern"
  Dialog.Filter = ["*.png", "Bilder"]
  If Dialog.SaveFile() Then
  Else
    hPic.Save(Dialog.Path)
    
  Endif
  
End

Public Sub ScrollArea1_Draw()
  
  Paint.Translate(- ScrollArea1.ScrollX, - ScrollArea1.ScrollY)
  Paint.DrawPicture(hPic, 0, 0)
  
End
